require("common/manifest.js");
require("common/vendor.js");
global.webpackJsonp([4],[,,,,,,function(e,n,t){"use strict";var r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o=i(t(1)),u=i(t(8)),s=i(t(12));function i(e){return e&&e.__esModule?e:{default:e}}o.default.config.productionTip=!1,o.default.prototype.$store=s.default,u.default.mpType="app",new o.default(r({},u.default)).$mount()},,function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(11),o=t.n(r),u=!1;var s=function(e){u||t(9)},i=t(0)(o.a,null,s,null,null);i.options.__file="..\\..\\..\\..\\..\\project\\uniapp\\SonFish\\App.vue",i.esModule&&Object.keys(i.esModule).some(function(e){return"default"!==e&&"__"!==e.substr(0,2)})&&console.error("named exports are not supported in *.vue files."),n.default=i.exports},function(e,n){},,function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0});var r=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},o=t(3);n.default={data:function(){return{provider:"weixin"}},computed:r({},(0,o.mapState)(["openid"])),methods:r({},(0,o.mapMutations)(["login"]),(0,o.mapActions)(["getUserOpenId"])),onLaunch:function(){var n=this;e.login({provider:this.provider,success:function(e){n.login(n.provider)},fail:function(e){console.log("fail",e)}}),this.getUserOpenId(!0)},onShow:function(){},onHide:function(){}}}).call(n,t(2).default)},function(e,n,t){"use strict";(function(e){Object.defineProperty(n,"__esModule",{value:!0});var r=i(t(13)),o=i(t(1)),u=i(t(3)),s=i(t(5));function i(e){return e&&e.__esModule?e:{default:e}}function f(e){return function(){var n=e.apply(this,arguments);return new Promise(function(e,t){return function r(o,u){try{var s=n[o](u),i=s.value}catch(e){return void t(e)}if(!s.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)}("next")})}}o.default.use(u.default);var a=new u.default.Store({state:{hasLogin:!1,authUserInfor:!1,loginProvider:"",openid:null,userInfor:null,userInforTemp:null},mutations:{login:function(e,n){e.hasLogin=!0,e.loginProvider=n},logout:function(e){e.hasLogin=!1,e.openid=null},setOpenid:function(e,n){e.openid=n},setUserInfor:function(e,n){e.userInfor=n},setUserInforTemp:function(e,n){e.userInforTemp=n},setAuthUserInfor:function(e,n){e.authUserInfor=n}},actions:{getUserInfoNormal:function(){var n=f(r.default.mark(function n(t){var o=t.state,u=t.commit,s=t.dispatch;return r.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise(function(n,t){o.userInfor?n(o.userInfor):e.getUserInfo({provider:"weixin",success:function(e){o.userInfor=e.userInfo,u("setAuthUserInfor",!0),s("updateUserInfor"),n(e.userInfo)}})});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),getUserInfOnload:function(){var n=f(r.default.mark(function n(t){var o=t.commit,u=t.state,s=t.dispatch;return r.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise(function(n,t){e.getUserInfo({provider:"weixin",success:function(e){o("setAuthUserInfor",!0),o("setUserInforTemp",e.userInfo),null==u.userInfor?(u.userInfor=u.userInforTemp,s("updateUserInfor"),n(u.userInfor)):u.userInfo!=u.userInforTemp?(u.userInfor=u.userInforTemp,s("updateUserInfor"),n(u.userInfor)):n(u.userInfor)},fail:function(){o("setAuthUserInfor",!1),s("authUserInforFun")}})});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}));return function(e){return n.apply(this,arguments)}}(),authUserInforFun:function(){console.log("get userInfor error"),e.showModal({title:"授权提示",content:"小程序需要您授权登录才能运行",showCancel:!1,complete:function(){console.log("提示结束"),e.switchTab({url:"/pages/user/user"})}})},updateUserInfor:function(n){var t=n.state;e.request({url:s.default.updateUserInfor,data:{openid:t.openid,userInfor:JSON.stringify(t.userInfor)},header:{"Content-type":"application/json"},method:"POST",success:function(e){console.log("update userInfor success!  ",e)},fail:function(e){console.log("update userInfor fail!  ",e)}})},getUserOpenId:function(){var n=f(r.default.mark(function n(t,o){var u=t.commit,i=t.state,f=t.dispatch;return r.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,new Promise(function(n,t){i.openid?n(i.openid):e.login({success:function(t){u("login","weixin"),e.request({url:s.default.openid,data:{code:t.code},header:{"Content-type":"application/json"},method:"POST",success:function(e){u("setOpenid",e.data),n(i.openid),o&&f("getUserInfOnload")},fail:function(e){console.log("获取用户openID错误",e)}}),setTimeout(function(){console.log(i.openid,i.hasLogin,i.loginProvider,i.authUserInfor,i.userInfor)},5e3)},fail:function(e){console.log("uni.login 接口调用失败，将无法正常使用开放接口等服务",e),t(e)}})});case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}},n,this)}));return function(e,t){return n.apply(this,arguments)}}()}});n.default=a}).call(n,t(2).default)}],[6]);
//# sourceMappingURL=../.sourcemap/mp-weixin/app.js.map